#!/bin/bash

# æ–°è¦ã‚¿ã‚¹ã‚¯å˜ä½ä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# Usage: ./scripts/create_task_unit.sh "task_name" "org_name" "priority" "complexity"

set -e

TASK_NAME=$1
ORG_NAME=$2
PRIORITY=${3:-"Medium"}
COMPLEXITY=${4:-"Medium"}

if [ -z "$TASK_NAME" ] || [ -z "$ORG_NAME" ]; then
    echo "Usage: $0 <task_name> <org_name> [priority] [complexity]"
    echo "Example: $0 'database_module' 'org-01' 'High' 'Complex'"
    exit 1
fi

echo "ğŸš€ æ–°è¦ã‚¿ã‚¹ã‚¯ä½œæˆé–‹å§‹: $TASK_NAME (çµ„ç¹”: $ORG_NAME)"

# ã‚¿ã‚¹ã‚¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
TASK_DIR="tasks"
mkdir -p "$TASK_DIR"

# ã‚¿ã‚¹ã‚¯è¦ä»¶ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
cat > "$TASK_DIR/${TASK_NAME}_requirements.md" << EOF
# ${TASK_NAME} å®Ÿè£…è¦ä»¶

## åŸºæœ¬æƒ…å ±
- **ã‚¿ã‚¹ã‚¯å**: ${TASK_NAME}
- **æ‹…å½“çµ„ç¹”**: ${ORG_NAME}
- **å„ªå…ˆåº¦**: ${PRIORITY}
- **è¤‡é›‘åº¦**: ${COMPLEXITY}
- **ä½œæˆæ—¥**: $(date +%Y-%m-%d)

## æ©Ÿèƒ½è¦ä»¶
- [ ] åŸºæœ¬æ©Ÿèƒ½ã®å®Ÿè£…
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…
- [ ] ãƒ­ã‚°æ©Ÿèƒ½ã®å®Ÿè£…
- [ ] è¨­å®šç®¡ç†ã®å®Ÿè£…

## éæ©Ÿèƒ½è¦ä»¶
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶ã®æº€è¶³
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ã®éµå®ˆ
- [ ] å¯ç”¨æ€§è¦ä»¶ã®ç¢ºä¿

## æŠ€è¡“ä»•æ§˜
- **è¨€èª**: Python 3.9+
- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: è¦ä»¶ã«å¿œã˜ã¦é¸æŠ
- **ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: pytest
- **å“è³ªãƒ„ãƒ¼ãƒ«**: black, flake8, mypy

## æˆæœç‰©
- \`src/${TASK_NAME}/\` - å®Ÿè£…ã‚³ãƒ¼ãƒ‰
- \`tests/\` - ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
- \`docs/\` - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

## å“è³ªåŸºæº–
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ > 95%
- é™çš„è§£æã‚¨ãƒ©ãƒ¼ 0ä»¶
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŸºæº–é”æˆ
EOF

# ã‚¿ã‚¹ã‚¯ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆä½œæˆ
cat > "$TASK_DIR/${TASK_NAME}_checklist.md" << EOF
# ğŸ“‹ ${TASK_NAME} é–‹ç™ºãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

## ğŸ“Š ãƒ¡ã‚¿æƒ…å ±
- **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å**: ${TASK_NAME}
- **æ‹…å½“çµ„ç¹”**: ${ORG_NAME}
- **é–‹å§‹æ—¥**: $(date +%Y-%m-%d)
- **æœŸé™**: $(date -d "+7 days" +%Y-%m-%d)
- **å„ªå…ˆåº¦**: ${PRIORITY}
- **è¤‡é›‘åº¦**: ${COMPLEXITY}

## ğŸ¯ è¦ä»¶å®šç¾©
- [ ] æ©Ÿèƒ½è¦ä»¶æ˜ç¢ºåŒ–
- [ ] éæ©Ÿèƒ½è¦ä»¶å®šç¾©
- [ ] ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ä»•æ§˜ç¢ºå®š
- [ ] ãƒ‡ãƒ¼ã‚¿æ§‹é€ è¨­è¨ˆ
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥
- [ ] ä»–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã®é€£æºä»•æ§˜

## ğŸ’» å®Ÿè£…è¦ä»¶
- [ ] ã‚³ã‚¢æ©Ÿèƒ½å®Ÿè£…
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Ÿè£…
- [ ] ãƒ­ã‚°æ©Ÿèƒ½å®Ÿè£…
- [ ] è¨­å®šç®¡ç†å®Ÿè£…
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

## ğŸ§ª ãƒ†ã‚¹ãƒˆè¦ä»¶
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆ (ã‚«ãƒãƒ¬ãƒƒã‚¸>95%)
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆ
- [ ] ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ä»¶
- [ ] APIæ–‡æ›¸
- [ ] ä½¿ç”¨ä¾‹ãƒ»ã‚µãƒ³ãƒ—ãƒ«
- [ ] è¨­å®šã‚¬ã‚¤ãƒ‰
- [ ] ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

## âœ… å“è³ªåŸºæº–
- [ ] é™çš„è§£æã‚¯ãƒªã‚¢
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ã‚¯ãƒªã‚¢
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŸºæº–æº€è¶³
- [ ] Final Bosså“è³ªç¢ºèªå®Œäº†
EOF

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã«è¿½åŠ 
if [ -f "PROJECT_CHECKLIST.md" ]; then
    echo "- [ ] ${TASK_NAME} (${ORG_NAME}) - $(date +%Y-%m-%d)" >> PROJECT_CHECKLIST.md
    echo "âœ… PROJECT_CHECKLIST.md ã«è¿½åŠ "
fi

echo "ğŸ¯ ã‚¿ã‚¹ã‚¯ä½œæˆå®Œäº†:"
echo "ğŸ“„ è¦ä»¶æ›¸: $TASK_DIR/${TASK_NAME}_requirements.md"
echo "ğŸ“‹ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ: $TASK_DIR/${TASK_NAME}_checklist.md"
echo "ğŸ“‚ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—: ./scripts/quick_send.sh boss0X \"æ–°ã‚¿ã‚¹ã‚¯: $TASK_NAME ã‚’é–‹å§‹ã—ã¦ãã ã•ã„\"" 